/*
 * ==================================================
 * [V6.2 ä¿®æ­£ç‰ˆ] Global Header (Mobile-First)
 * ç­–ç•¥ï¼š
 * 1. ä¿®æ­£ V6.1 è¡Œå‹•ç‰ˆ Toggle æœªé å³çš„ä½ˆå±€å•é¡Œã€‚
 * 2. æ¡Œé¢ç‰ˆï¼šä¿æŒ V6.1 çš„ "Logo-Left, Nav-Center" ä½ˆå±€ã€‚
 * ==================================================
 */

/* --- 0. ç³»çµ±è®Šæ•¸ (å»ºè­°æ”¾åœ¨ :root) --- */
/*
  :root {
    --z-index-dropdown: 1000;
    --z-index-header-nav: 1500;
    --z-index-header: 2000;
  }
*/
/* è¨»ï¼šz-index è®Šæ•¸é€šå¸¸æœƒæ”¾åœ¨ _c-00-tokens.scss ä¸­çµ±ä¸€ç®¡ç† */


/* --- 1. Header åŸºç¤çµæ§‹ (Mobile & Desktop å…±é€š) --- */
.global-header {
  background: var(--color-white);
  border-bottom: 1px solid var(--color-border);
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--header-h);
  z-index: var(--z-index-header);
  display: flex;
  align-items: center;
}

.global-header nav {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 20px;
}

.header-logo {
  display: flex;
  align-items: center;
  flex-shrink: 0;
}

.header-logo img {
  height: 40px !important;
  width: 40px !important;
  max-width: 100%;
}

/* --- 2. è¡Œå‹•ç‰ˆå°èˆª (Mobile-First Default) --- */
.mobile-nav-toggle {
  display: block;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--color-dark);

  /* * [ ğŸš€ V6.2 ä¿®æ­£ ]
   * é€™æ˜¯ä¿®æ­£è¡Œå‹•ç‰ˆè·‘ç‰ˆçš„é—œéµã€‚
   * ä½¿ç”¨ auto margin å°‡æ­¤æŒ‰éˆ•æ¨åˆ° flex å®¹å™¨çš„æœ€å³å´ã€‚
   * é€™å–ä»£äº†åœ¨ nav ä¸Šä½¿ç”¨ 'justify-content: space-between' çš„èˆŠæ–¹æ³•ã€‚
   */
  margin-left: auto;
}

.header-nav {
  display: none;
}

.header-cta {
  display: none;
}

/* --- 3. å…¨å±€é¡è‰²èˆ‡é€£çµæ¨£å¼ --- */
.header-nav a,
.nav-dropdown-trigger,
.header-cta {
  color: var(--nav-link) !important;
  cursor: pointer; 
}

/* é ‚å±¤é¸å–®çš„ Hover æ•ˆæœ */
.header-nav > li > a:hover,
.header-nav > li > a:focus-visible,
.header-nav > li > a.active,
.dropdown:hover > .nav-dropdown-trigger,
.nav-dropdown-trigger[aria-expanded=true], /* JS (è¡Œå‹•ç‰ˆ) */
.header-cta:hover,
.header-cta:focus-visible {
  color: var(--nav-link-hover) !important;
  text-decoration: underline;
  text-underline-offset: 3px;
}

/* çµ±ä¸€çš„ Focus æ¨£å¼ */
.header-nav a:focus-visible,
.nav-dropdown-trigger:focus-visible,
.header-cta:focus-visible,
.mobile-nav-toggle:focus-visible {
  outline: 2px solid var(--focus-ring);
  outline-offset: 2px;
  border-radius: 4px;
}

/* --- 4. è¡Œå‹•ç‰ˆ L1 é¸å–®é–‹å•Ÿç‹€æ…‹ (Mobile State: .is-open) --- */
.header-nav.is-open {
  display: block;
  position: absolute;
  top: var(--header-h);
  left: 0;
  right: 0;
  width: 100%;
  background: var(--color-white);
  border-top: 1px solid var(--color-border);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  z-index: var(--z-index-header-nav);
  max-height: calc(100vh - var(--header-h));
  overflow-y: auto;
}

/* è¡Œå‹•ç‰ˆ L1 é€£çµ */
.header-nav.is-open > li > a {
  display: block;
  padding: 16px 20px;
  border-bottom: 1px solid var(--color-border);
}

.header-nav.is-open > li > a:hover {
  background-color: #f0f0f0;
}

/* [V6.0] è¡Œå‹•ç‰ˆ L2 ä¸‹æ‹‰é¸å–®é‚è¼¯ (ç”± JS æ§åˆ¶) */
.header-nav.is-open .dropdown-menu {
  display: none; /* é è¨­éš±è— */
  padding-left: 20px; /* å…§ç¸® */
  background: #fafafa;
  border-bottom: 1px solid var(--color-border);
}

.header-nav.is-open .dropdown.is-open > .dropdown-menu {
  display: block; /* JS é»æ“Šæ™‚é¡¯ç¤º */
}

.header-nav.is-open .dropdown-menu a {
  display: block;
  padding: 12px 20px;
  border-bottom: 1px dashed var(--color-border);
  color: var(--mega-link);
}
.header-nav.is-open .dropdown-menu li:last-child a {
  border-bottom: none;
}
.header-nav.is-open .dropdown-menu a:hover {
  background-color: #f0f0f0;
  color: var(--mega-link-hover);
}


/* --- 5. æ¡Œé¢ç‰ˆå°èˆª (Desktop @media) --- */
@media (min-width: 992px) {
  
  /* [çµæ§‹ä¿®æ­£] å•Ÿç”¨æ¡Œé¢ç‰ˆçš„ç¾¤çµ„åŒ…è£å™¨ */
  .header-navigation-wrapper {
    display: flex;
    align-items: center;
    /* é€™å€‹ gap æ˜¯ .header-nav å’Œ .header-cta ä¹‹é–“çš„é–“è· */
    gap: 25px; 
    
    /* [ç½®ä¸­ä¿®æ”¹] ä½¿ç”¨ auto margin å¯¦ç¾ç½®ä¸­ */
    margin-left: auto;
    margin-right: auto;
  }
  
  /* 5.1 é¡¯ç¤ºæ¡Œé¢å…ƒç´  */
  .mobile-nav-toggle { display: none; }
  .header-cta { display: inline-flex; align-items: center; }

  /* [V6.1 é—œéµä¿®å¾©] æé«˜ç‰¹ç•°æ€§ï¼Œç¢ºä¿ 100% è¦†è“‹ .is-open */
  .header-nav,
  .header-nav.is-open {
    display: flex;
    align-items: center;
    gap: 25px; /* é€™å€‹ gap æ˜¯ L1 é€£çµ (li) ä¹‹é–“çš„é–“è· */
    /* è¦†è“‹è¡Œå‹•ç‰ˆ .is-open æ¨£å¼ */
    position: static;
    border-top: none;
    box-shadow: none;
    max-height: none;
    overflow: visible;
    background: none;
    width: auto; /* [é—œéµä¿®å¾©] è¦†è“‹è¡Œå‹•ç‰ˆçš„ width: 100% */
  }

  /* è¦†è“‹è¡Œå‹•ç‰ˆ L1 é€£çµæ¨£å¼ */
  .header-nav.is-open > li > a,
  .header-nav > li > a {
    display: inline;
    padding: 0;
    border-bottom: none;
  }
  .header-nav.is-open > li > a:hover,
  .header-nav > li > a:hover {
    background: none;
  }

  /* 5.2 [V6.0] æ¡Œé¢ç‰ˆ L2 ä¸‹æ‹‰é¸å–® (ç´” CSS :hover) */
  .dropdown {
    position: relative;
  }

  /* éš±è—è¡Œå‹•ç‰ˆ JS ç‹€æ…‹ (ä¿éšª) */
  .header-nav.is-open .dropdown-menu,
  .header-nav.is-open .dropdown.is-open > .dropdown-menu {
    display: none;
    padding-left: 0;
    background: none;
    border-bottom: none;
  }
  
  /* æ¡Œé¢ç‰ˆ L2 åŸºç¤æ¨£å¼ */
  .dropdown-menu {
    display: none; /* é—œéµï¼šé è¨­éš±è— */
    position: absolute;
    top: 100%;
    left: 0;
    z-index: var(--z-index-dropdown);
    
    /* [V6.0] çµ±ä¸€ç°¡åŒ–æ¨£å¼ */
    width: max-content;
    min-width: 200px; 
    padding: 10px;
    background: var(--mega-bg);
    border: 1px solid var(--mega-border);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    border-radius: 8px;

    /* å‹•ç•« (åƒè€ƒ style.css) */
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s;
  }

  /* æ¡Œé¢ç‰ˆ L2 é€£çµæ¨£å¼ */
  .dropdown-menu a {
    display: block;
    padding: 10px 15px;
    white-space: nowrap;
    color: var(--mega-link);
    border-radius: 6px;
    border-bottom: none; /* è¦†è“‹è¡Œå‹•ç‰ˆæ¨£å¼ */
  }

  .dropdown-menu a:hover {
    color: var(--mega-link-hover);
    background: var(--mega-hover-bg);
    text-decoration: none;
  }

  /* [V6.0] æ¡Œé¢ç‰ˆ :hover è§¸ç™¼ */
  .dropdown:hover > .dropdown-menu {
    display: block;
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

} /* çµæŸ @media (min-width: 992px) */